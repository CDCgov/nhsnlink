openapi: 3.0.4
info:
  version: 0.3.0
  title: Census
paths:
  /api/census/{facilityId}/history:
    get:
      tags:
      - Census
      summary: Gets Patient List history for a facility.
      parameters:
      - name: facilityId
        in: path
        description: ""
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            text/plain:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PatientCensusHistoricEntity'
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PatientCensusHistoricEntity'
            text/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PatientCensusHistoricEntity'
        "500":
          description: Internal Server Error
  /api/census/{facilityId}/history/admitted:
    get:
      tags:
      - Census
      summary: Gets the admitted patients for a facility within a date range. If no dates are provided, it will return all active patients.
      parameters:
      - name: facilityId
        in: path
        description: ""
        required: true
        schema:
          type: string
      - name: startDate
        in: query
        description: ""
        schema:
          type: string
          format: date-time
      - name: endDate
        in: query
        description: ""
        schema:
          type: string
          format: date-time
      responses:
        "200":
          description: OK
          content:
            text/plain:
              schema:
                type: object
                additionalProperties: {}
            application/json:
              schema:
                type: object
                additionalProperties: {}
            text/json:
              schema:
                type: object
                additionalProperties: {}
        "500":
          description: Internal Server Error
  /api/census/{facilityId}/current:
    get:
      tags:
      - Census
      summary: Gets the current census for a facility.
      parameters:
      - name: facilityId
        in: path
        description: ""
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            text/plain:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CensusPatientListEntity'
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CensusPatientListEntity'
            text/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CensusPatientListEntity'
        "500":
          description: Internal Server Error
  /api/census/{facilityId}/all:
    get:
      tags:
      - Census
      parameters:
      - name: facilityId
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            text/plain:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CensusPatientListEntity'
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CensusPatientListEntity'
            text/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CensusPatientListEntity'
        "500":
          description: Internal Server Error
  /api/census/config:
    post:
      tags:
      - CensusConfig
      summary: Creates a CensusConfig for o given censusConfig
      requestBody:
        description: ""
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CensusConfigModel'
          text/json:
            schema:
              $ref: '#/components/schemas/CensusConfigModel'
          application/*+json:
            schema:
              $ref: '#/components/schemas/CensusConfigModel'
      responses:
        "201":
          description: Created
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/CensusConfigEntity'
            application/json:
              schema:
                $ref: '#/components/schemas/CensusConfigEntity'
            text/json:
              schema:
                $ref: '#/components/schemas/CensusConfigEntity'
        "400":
          description: Bad Request
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
            text/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        "500":
          description: Internal Server Error
  /api/census/config/{facilityId}:
    get:
      tags:
      - CensusConfig
      summary: Returns the CensusConfig for a given facilityId
      parameters:
      - name: facilityId
        in: path
        description: ""
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/CensusConfigModel'
            application/json:
              schema:
                $ref: '#/components/schemas/CensusConfigModel'
            text/json:
              schema:
                $ref: '#/components/schemas/CensusConfigModel'
        "500":
          description: Internal Server Error
    put:
      tags:
      - CensusConfig
      summary: Updates a CensusConfig for a given censusConfigModel and facilityId
      parameters:
      - name: facilityId
        in: path
        description: ""
        required: true
        schema:
          type: string
      requestBody:
        description: ""
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CensusConfigModel'
          text/json:
            schema:
              $ref: '#/components/schemas/CensusConfigModel'
          application/*+json:
            schema:
              $ref: '#/components/schemas/CensusConfigModel'
      responses:
        "202":
          description: Accepted
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/CensusConfigEntity'
            application/json:
              schema:
                $ref: '#/components/schemas/CensusConfigEntity'
            text/json:
              schema:
                $ref: '#/components/schemas/CensusConfigEntity'
        "201":
          description: Created
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/CensusConfigEntity'
            application/json:
              schema:
                $ref: '#/components/schemas/CensusConfigEntity'
            text/json:
              schema:
                $ref: '#/components/schemas/CensusConfigEntity'
        "400":
          description: Bad Request
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
            text/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        "500":
          description: Internal Server Error
    delete:
      tags:
      - CensusConfig
      summary: Deletes the CensusConfig for a given facilityId
      parameters:
      - name: facilityId
        in: path
        description: ""
        required: true
        schema:
          type: string
      responses:
        "204":
          description: No Content
        "500":
          description: Internal Server Error
  /health:
    get:
      tags:
      - Health
      summary: Health check endpoint
      description: Returns the health status of the service and its dependencies
      responses:
        "200":
          description: Healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    description: Overall health status
                  totalDuration:
                    type: string
                    description: Total duration of health checks
                  entries:
                    type: object
                    properties:
                      Database:
                        type: object
                        properties:
                          status:
                            type: string
                          description:
                            type: string
                          duration:
                            type: string
                          data:
                            type: object
                      Kafka:
                        type: object
                        properties:
                          status:
                            type: string
                          description:
                            type: string
                          duration:
                            type: string
                          data:
                            type: object
        "503":
          description: Unhealthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    description: Overall health status
                  totalDuration:
                    type: string
                    description: Total duration of health checks
                  entries:
                    type: object
                    properties:
                      Database:
                        type: object
                        properties:
                          status:
                            type: string
                          description:
                            type: string
                          duration:
                            type: string
                          data:
                            type: object
                      Kafka:
                        type: object
                        properties:
                          status:
                            type: string
                          description:
                            type: string
                          duration:
                            type: string
                          data:
                            type: object
components:
  schemas:
    CensusConfigEntity:
      type: object
      properties:
        id:
          type: string
          nullable: true
        createDate:
          type: string
          format: date-time
        modifyDate:
          type: string
          format: date-time
          nullable: true
        facilityID:
          type: string
          nullable: true
        scheduledTrigger:
          type: string
          nullable: true
      additionalProperties: false
    CensusConfigModel:
      required:
      - facilityId
      - scheduledTrigger
      type: object
      properties:
        facilityId:
          minLength: 1
          type: string
        scheduledTrigger:
          minLength: 1
          type: string
      additionalProperties: false
    CensusPatientListEntity:
      type: object
      properties:
        id:
          type: string
          nullable: true
        createDate:
          type: string
          format: date-time
        modifyDate:
          type: string
          format: date-time
          nullable: true
        facilityId:
          type: string
          nullable: true
        patientId:
          type: string
          nullable: true
        displayName:
          type: string
          nullable: true
        admitDate:
          type: string
          format: date-time
          nullable: true
        isDischarged:
          type: boolean
        dischargeDate:
          type: string
          format: date-time
          nullable: true
      additionalProperties: false
    PatientCensusHistoricEntity:
      type: object
      properties:
        id:
          type: string
          nullable: true
        createDate:
          type: string
          format: date-time
        modifyDate:
          type: string
          format: date-time
          nullable: true
        facilityId:
          type: string
          nullable: true
        censusDateTime:
          type: string
          format: date-time
        reportId:
          type: string
          nullable: true
      additionalProperties: false
    ProblemDetails:
      type: object
      properties:
        type:
          type: string
          nullable: true
        title:
          type: string
          nullable: true
        status:
          type: integer
          format: int32
          nullable: true
        detail:
          type: string
          nullable: true
        instance:
          type: string
          nullable: true
      additionalProperties: {}

